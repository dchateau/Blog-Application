import type { NextPage } from "next";
import Head from "next/head";
import type { GetStaticProps, InferGetStaticPropsType } from "next";

import { getCategories, getPosts } from "@post/helpers";
import PostsPage from "../src/post/pages/PostsPage";
import { CategoryFields, PostFields } from "@typings/contentful";

// const posts = data.filter((item) => item.sys.contentType.sys.id === "post");
// const definedPages = posts.map((post) => post.fields.slug);

const Home = ({
  categories,
  posts,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  // console.log("Posts: ", posts)
  // console.log("Defined pages: ", definedPages);
  return (
    <div>
      <Head>
        <title>Blog application</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <PostsPage posts={posts} categories={categories} />

      {/* <main >
        <h1>Main application</h1>
      </main>

      <footer >
        
          Powered by{' '}
      </footer> */}
    </div>
  );
};

export default Home;

export const getStaticProps: GetStaticProps<{
  categories: CategoryFields[];
  posts: PostFields[];
}> = async (props) => {
  // const {locale} = props;
  // const { slug } = params;
  // console.log({ slug });
  const posts: PostFields[] = getPosts();
  const categories: CategoryFields[] = getCategories();

  console.log("index props: ", props);

  return {
    props: {
      categories,
      posts,
      ...props,
    },
  };
};
